<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HealCity - Helwan Environmental Recovery</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      :root {
        --primary: #27ae60;
        --secondary: #3498db;
        --accent: #e74c3c;
        --background: #f0f2f5;
        --card-bg: #ffffff;
        --text: #333333;
        --text-light: #777777;
        --shadow: rgba(0, 0, 0, 0.1);
        --light: #f8f9fa;
        --transition: all 0.3s ease;
      }

      .dark-mode {
        --primary: #2ecc71;
        --secondary: #3498db;
        --accent: #e74c3c;
        --background: #121212;
        --card-bg: #1e1e1e;
        --text: #f0f0f0;
        --text-light: #aaaaaa;
        --light: #2d2d2d;
        --shadow: rgba(0, 0, 0, 0.3);
      }

      body {
        background: var(--background);
        color: var(--text);
        min-height: 100vh;
        transition: var(--transition);
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      /* Welcome Section */
      .welcome-section {
        background: var(--card-bg);
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 5px 15px var(--shadow);
        max-width: 800px;
        margin: 50px auto;
        text-align: center;
        transition: var(--transition);
      }

      .welcome-title {
        color: var(--primary);
        margin-bottom: 30px;
        font-size: 2.5rem;
      }

      .welcome-description {
        background: var(--background);
        padding: 25px;
        border-radius: 10px;
        margin-bottom: 30px;
        line-height: 1.7;
        font-size: 1.1rem;
        border-left: 4px solid var(--primary);
        text-align: left;
      }

      .btn {
        padding: 15px 40px;
        border: none;
        border-radius: 8px;
        background: var(--primary);
        color: white;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
      }

      .btn:hover {
        background: #219653;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      /* Sign In Section */
      #signinBox {
        background: var(--card-bg);
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px var(--shadow);
        max-width: 400px;
        margin: 20px auto;
        text-align: center;
        transition: var(--transition);
      }

      #usernameInput {
        width: 100%;
        padding: 12px;
        margin-bottom: 15px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 1rem;
        background: var(--card-bg);
        color: var(--text);
        transition: var(--transition);
      }

      #usernameInput:focus {
        border-color: var(--primary);
        outline: none;
      }

      #userWelcome {
        text-align: center;
        font-size: 1.2rem;
        color: var(--primary);
        margin: 10px 0;
        font-weight: 600;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.5s ease;
      }

      #userWelcome.show {
        opacity: 1;
        transform: translateY(0);
      }

      #signoutBtn {
        background: var(--accent);
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 5px;
        cursor: pointer;
        margin: 10px auto;
        display: block;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.5s ease 0.2s;
      }

      #signoutBtn.show {
        opacity: 1;
        transform: translateY(0);
      }

      /* Header & Navigation */
      header {
        background: var(--card-bg);
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px var(--shadow);
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: var(--transition);
        position: sticky;
        top: 20px;
        z-index: 100;
        opacity: 0;
        transform: translateY(-20px);
        transition: all 0.5s ease;
      }

      header.show {
        opacity: 1;
        transform: translateY(0);
      }

      .logo {
        font-size: 2rem;
        font-weight: bold;
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .nav-tabs {
        display: flex;
        gap: 10px;
      }

      /* Navigation Links */
      .nav-links {
        display: flex;
        gap: 20px;
      }

      .nav-links a {
        color: var(--text);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
        position: relative;
        padding: 8px 16px;
        border-radius: 5px;
      }

      /* Hover effect */
      .nav-links a:hover {
        color: var(--primary);
        background: rgba(39, 174, 96, 0.1);
      }

      /* Active link style */
      .nav-links a.active {
        color: var(--primary);
      }

      /* Active link underline */
      .nav-links a.active::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 100%;
        height: 2px;
        background: var(--primary);
      }

      .dark-mode-toggle {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--text);
        transition: var(--transition);
      }

      /* Game Section */
      .game-section {
        display: none;
        opacity: 0;
        transition: opacity 0.5s ease;
      }

      .game-section.show {
        opacity: 1;
      }

      .game-area {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
      }

      .city-status {
        background: var(--card-bg);
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 2px 10px var(--shadow);
        transition: var(--transition);
      }

      .city-image {
        width: 150px;
        height: 150px;
        margin: 15px auto;
        border-radius: 50%;
        background: linear-gradient(45deg, #e74c3c, #f39c12);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 4rem;
        border: 3px solid #ddd;
        transition: var(--transition);
      }

      .health-bar {
        width: 100%;
        height: 20px;
        background: #ddd;
        border-radius: 10px;
        margin: 10px 0;
        overflow: hidden;
        position: relative;
      }

      .health-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          #e74c3c,
          #f39c12,
          #f1c40f,
          #2ecc71,
          #27ae60
        );
        width: 15%;
        transition: width 0.5s ease;
      }

      .health-marker {
        position: absolute;
        height: 100%;
        width: 2px;
        background: rgba(0, 0, 0, 0.3);
      }

      .actions {
        background: var(--card-bg);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px var(--shadow);
        transition: var(--transition);
      }

      .action-btn {
        width: 100%;
        padding: 12px;
        margin: 8px 0;
        border: none;
        border-radius: 8px;
        background: var(--secondary);
        color: white;
        font-size: 1rem;
        cursor: pointer;
        transition: var(--transition);
        text-align: left;
        padding-left: 15px;
        position: relative;
        overflow: hidden;
      }

      .action-btn:hover {
        background: #2980b9;
        transform: translateX(5px);
      }

      .action-btn:disabled {
        background: #95a5a6;
        cursor: not-allowed;
        transform: none;
      }

      .action-progress {
        position: absolute;
        bottom: 0;
        left: 0;
        height: 3px;
        background: #2ecc71;
        width: 0%;
        transition: width 0.1s linear;
      }

      .solution-description {
        background: var(--background);
        padding: 15px;
        border-radius: 8px;
        margin-top: 10px;
        font-size: 0.9rem;
        line-height: 1.5;
        border-left: 3px solid var(--primary);
        display: none;
      }

      .solution-description.active {
        display: block;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin-bottom: 20px;
      }

      .stat-card {
        background: var(--card-bg);
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 10px var(--shadow);
        transition: var(--transition);
      }

      .stat-card:hover {
        transform: translateY(-5px);
      }

      .stat-value {
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--secondary);
        margin: 5px 0;
      }

      .level-indicator {
        display: flex;
        justify-content: space-between;
        margin: 20px 0;
      }

      .level-dot {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background: #ddd;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        transition: var(--transition);
      }

      .level-dot.active {
        background: var(--secondary);
        color: white;
        transform: scale(1.1);
      }

      .level-dot.completed {
        background: var(--primary);
        color: white;
      }

      .map-section {
        background: var(--card-bg);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px var(--shadow);
        margin-bottom: 20px;
        transition: var(--transition);
      }

      .map-container {
        width: 100%;
        height: 400px;
        border-radius: 8px;
        margin: 15px 0;
        overflow: hidden;
      }

      #helwanMap {
        width: 100%;
        height: 100%;
        border-radius: 8px;
      }

      .restart-btn {
        background: var(--accent);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 10px;
        transition: var(--transition);
      }

      .restart-btn:hover {
        background: #c0392b;
        transform: scale(1.05);
      }

      /* Progress Section */
      .progress-section {
        background: var(--card-bg);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px var(--shadow);
        margin-bottom: 20px;
        transition: var(--transition);
      }

      .progress {
        background: var(--background);
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 10px;
        box-shadow: 0 2px 5px var(--shadow);
        display: flex;
        align-items: center;
        opacity: 0.5;
        transition: var(--transition);
      }

      .progress.unlocked {
        opacity: 1;
        background: #f8ffd7;
      }

      .dark-mode .progress.unlocked {
        background: #2a3a2a;
      }

      .progress-icon {
        font-size: 1.5rem;
        margin-right: 10px;
      }

      /* Environmental Info Section */
      .environmental-info {
        background: var(--card-bg);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px var(--shadow);
        margin-bottom: 20px;
        transition: var(--transition);
      }

      .comparison-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-top: 20px;
      }

      .comparison-card {
        background: var(--card-bg);
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 5px var(--shadow);
        border: 2px solid var(--primary);
        transition: var(--transition);
      }

      .comparison-card:hover {
        transform: translateY(-5px);
      }

      .comparison-image {
        width: 100%;
        height: 200px;
        border-radius: 5px;
        margin: 15px 0;
        overflow: hidden;
        position: relative;
      }

      .comparison-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .comparison-title {
        text-align: center;
        font-size: 1.3rem;
        font-weight: bold;
        margin-bottom: 15px;
        color: var(--primary);
      }

      .comparison-stats {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
        margin-top: 15px;
      }

      .stat-item {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #eee;
      }

      .stat-label {
        font-weight: 500;
        color: var(--text-light);
      }

      .stat-value-comp {
        font-weight: bold;
        color: var(--secondary);
      }

      /* Three Stats Section */
      .three-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin: 30px 0;
      }

      .environment-stat {
        background: var(--card-bg);
        padding: 25px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 2px 10px var(--shadow);
        transition: var(--transition);
        border-top: 4px solid var(--primary);
      }

      .environment-stat:hover {
        transform: translateY(-5px);
      }

      .stat-icon {
        font-size: 2.5rem;
        margin-bottom: 15px;
        color: var(--primary);
      }

      .stat-title {
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: 10px;
        color: var(--text);
      }

      .stat-desc {
        color: var(--text-light);
        line-height: 1.5;
      }

      .completion-message {
        background: var(--primary);
        color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        margin: 20px 0;
        display: none;
      }

      .completion-message.active {
        display: block;
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (max-width: 768px) {
        .game-area {
          grid-template-columns: 1fr;
        }

        .stats {
          grid-template-columns: 1fr;
        }

        .comparison-container {
          grid-template-columns: 1fr;
          gap: 20px;
        }

        .three-stats {
          grid-template-columns: 1fr;
        }

        .nav-links {
          flex-wrap: wrap;
          justify-content: center;
        }

        header {
          flex-direction: column;
          gap: 15px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Welcome Section -->
    <div class="welcome-section" id="welcomeSection">
      <h2 class="welcome-title">Welcome to HealCity</h2>

      <div class="welcome-description">
        <p>
          <strong>HealCity</strong> is an interactive educational game that
          simulates environmental recovery efforts in Helwan, Egypt.
        </p>

        <p>
          <strong>Mission:</strong> Help restore Helwan's environment by
          implementing sustainable solutions and learn about real environmental
          challenges.
        </p>

        <p><strong>How to Play:</strong></p>
        <ul style="margin-left: 20px; margin-top: 10px">
          <li>Click on environmental actions to improve city health</li>
          <li>Each action has a cooldown period</li>
          <li>Monitor environmental statistics</li>
          <li>Unlock achievements as you progress</li>
          <li>Reach 100% health to complete the game</li>
        </ul>
      </div>

      <button class="btn" id="nextBtn">Start Game →</button>
    </div>

    <!-- Game Section -->
    <div class="game-section" id="gameSection">
      <!-- Sign In Section -->
      <div id="signinBox">
        <h3>Please Enter Your Name to Begin</h3>
        <input type="text" id="usernameInput" placeholder="Enter your name" />
        <button
          class="btn"
          id="signinBtn"
          style="width: 100%; margin-bottom: 10px"
        >
          Sign In
        </button>
        <p
          id="signinMessage"
          style="color: var(--accent); margin-top: 10px; display: none"
        >
          Please enter your name to continue
        </p>
      </div>
      <div id="userWelcome"></div>
      <button id="signoutBtn">Sign Out</button>

      <header>
        <div class="logo">
          <i class="fas fa-leaf"></i>
          HealCity
        </div>
        <div class="nav-links">
          <a href="#" class="active" data-tab="home">Home</a>
          <a href="#" data-tab="progress">Progress</a>
          <a href="#" data-tab="map">Map City Info</a>
          <a href="#" data-tab="info">Helwan Information</a>
        </div>
        <button class="dark-mode-toggle" id="darkModeToggle">
          <i class="fas fa-moon"></i>
        </button>
      </header>

      <!-- Completion Message -->
      <div class="completion-message" id="completionMessage">
        <h2>🎉 City Fully Restored! 🎉</h2>
        <p>Congratulations! You have successfully healed Helwan City!</p>
        <p>The city is now environmentally sustainable and healthy.</p>
      </div>

      <!-- Home Tab -->
      <div class="tab-content active" id="homeTab">
        <div class="game-area">
          <div class="city-status">
            <h2>Helwan City</h2>
            <div class="city-image">
              <span id="cityEmoji">😔</span>
            </div>
            <div class="health-bar">
              <div class="health-fill" id="healthFill"></div>
              <div class="health-marker" style="left: 25%"></div>
              <div class="health-marker" style="left: 50%"></div>
              <div class="health-marker" style="left: 75%"></div>
            </div>
            <div>City Health: <span id="healthPercent">15%</span></div>
            <div id="cityMessage">I need your help! Please heal me.</div>

            <div class="level-indicator">
              <div class="level-dot completed">1</div>
              <div class="level-dot">2</div>
              <div class="level-dot">3</div>
              <div class="level-dot">4</div>
            </div>
          </div>

          <div class="actions">
            <h3>Healing Actions</h3>

            <button class="action-btn" id="treesBtn">
              🌳 Plant Trees (+8%)
              <div class="action-progress" id="treesProgress"></div>
            </button>
            <div class="solution-description" id="treesDesc">
              <strong>Tree Planting Initiative:</strong> Establishing urban
              forests and increasing green cover. Trees absorb CO2, reduce air
              pollution, provide shade, and combat urban heat island effect.
            </div>

            <button class="action-btn" id="energyBtn">
              ☀ Clean Energy (+7%)
              <div class="action-progress" id="energyProgress"></div>
            </button>
            <div class="solution-description" id="energyDesc">
              <strong>Renewable Energy Transition:</strong> Installing solar
              panels and wind turbines to replace fossil fuels. Reduces
              greenhouse gas emissions and decreases air pollution.
            </div>

            <button class="action-btn" id="recycleBtn">
              ♻ Recycling (+5%)
              <div class="action-progress" id="recycleProgress"></div>
            </button>
            <div class="solution-description" id="recycleDesc">
              <strong>Waste Management System:</strong> Implementing
              comprehensive recycling programs and waste segregation. Reduces
              landfill waste and conserves natural resources.
            </div>

            <button class="action-btn" id="roofsBtn">
              🏢 Green Roofs (+6%)
              <div class="action-progress" id="roofsProgress"></div>
            </button>
            <div class="solution-description" id="roofsDesc">
              <strong>Urban Green Infrastructure:</strong> Converting building
              rooftops into green spaces. Improves insulation, absorbs
              rainwater, and reduces urban heat.
            </div>

            <button class="action-btn" id="transportBtn">
              🚲 Sustainable Transport (+6%)
              <div class="action-progress" id="transportProgress"></div>
            </button>
            <div class="solution-description" id="transportDesc">
              <strong>Eco-friendly Transportation:</strong> Developing bike
              lanes, pedestrian zones, and electric public transport. Reduces
              traffic congestion and air pollution.
            </div>

            <button class="action-btn" id="awarenessBtn">
              📢 Community Awareness (+4%)
              <div class="action-progress" id="awarenessProgress"></div>
            </button>
            <div class="solution-description" id="awarenessDesc">
              <strong>Environmental Education:</strong> Public campaigns and
              school programs about sustainability. Empowers citizens with
              knowledge and changes behaviors.
            </div>

            <button class="restart-btn" id="restartBtn">🔄 Restart Game</button>
          </div>
        </div>

        <div class="stats">
          <div class="stat-card">
            <div>Air Quality</div>
            <div class="stat-value" id="airQuality">75</div>
            <div>Index</div>
          </div>
          <div class="stat-card">
            <div>Vegetation</div>
            <div class="stat-value" id="vegetation">25</div>
            <div>Cover</div>
          </div>
          <div class="stat-card">
            <div>Temperature</div>
            <div class="stat-value" id="temperature">36</div>
            <div>°C</div>
          </div>
        </div>
      </div>

      <!-- Progress Tab -->
      <div class="tab-content" id="progressTab">
        <div class="progress-section">
          <h3>My Progress</h3>
          <div class="progress" id="firstStep">
            <div class="progress-icon">🌱</div>
            <div>
              <strong>First Step</strong>
              <div>Reach 25% city health</div>
            </div>
          </div>
          <div class="progress" id="halfway">
            <div class="progress-icon">🌿</div>
            <div>
              <strong>Halfway There</strong>
              <div>Reach 50% city health</div>
            </div>
          </div>
          <div class="progress" id="greenCity">
            <div class="progress-icon">🌳</div>
            <div>
              <strong>Green City</strong>
              <div>Reach 75% city health</div>
            </div>
          </div>
          <div class="progress" id="fullyHealed">
            <div class="progress-icon">🏆</div>
            <div>
              <strong>Fully Healed</strong>
              <div>Reach 100% city health</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Map Tab -->
      <div class="tab-content" id="mapTab">
        <div class="map-section">
          <h3>Helwan City Map</h3>
          <div class="map-container">
            <div id="helwanMap"></div>
          </div>
          <p>
            Interactive map of Helwan showing key locations and environmental
            data. Helwan is located south of Cairo along the Nile River.
          </p>
        </div>
      </div>

      <!-- Environmental Info Tab -->
      <div class="tab-content" id="infoTab">
        <div class="environmental-info">
          <h3>Helwan Environmental Comparison: 2001 vs 2024</h3>
          <p>
            Compare the environmental changes in Helwan over two decades and see
            the impact of industrial development and environmental efforts.
          </p>

          <div class="comparison-container">
            <div class="comparison-card">
              <div class="comparison-title">2001 - Before</div>
              <div class="comparison-image">
                <img
                  src="https://wvs.earthdata.nasa.gov/api/v1/snapshot?REQUEST=GetSnapshot&TIME=2001-05-28T00:00:00Z&BBOX=29.6003,30.7698,30.483,31.792&CRS=EPSG:4326&LAYERS=MODIS_Terra_CorrectedReflectance_TrueColor,MODIS_Combined_L3_IGBP_Land_Cover_Type_Annual,GRUMP_Settlements,Coastlines_15m&WRAP=day,none,x,x&FORMAT=image/jpeg&WIDTH=465&HEIGHT=402&colormaps=,MODIS_IGBP_Land_Cover_Type,GRUMP_Settlements,&MARKER=31.3372,29.8454&ts=1759554088131"
                  alt="Helwan 2001 Satellite Image"
                />
              </div>
              <p>
                In 2001, Helwan had limited urban development with more natural
                desert areas and lower temperatures.
              </p>

              <div class="comparison-stats">
                <div class="stat-item">
                  <span class="stat-label">Urban Area:</span>
                  <span class="stat-value-comp">15%</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Population Density:</span>
                  <span class="stat-value-comp">Low</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Temperature:</span>
                  <span class="stat-value-comp">32°C</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Vegetation:</span>
                  <span class="stat-value-comp">20%</span>
                </div>
              </div>
            </div>

            <div class="comparison-card">
              <div class="comparison-title">2024 - After</div>
              <div class="comparison-image">
                <img
                  src="https://wvs.earthdata.nasa.gov/api/v1/snapshot?REQUEST=GetSnapshot&TIME=2024-05-28T00:00:00Z&BBOX=29.6502,30.8349,30.4898,31.8073&CRS=EPSG:4326&LAYERS=MODIS_Terra_CorrectedReflectance_TrueColor,MODIS_Combined_L3_IGBP_Land_Cover_Type_Annual,GRUMP_Settlements,Coastlines_15m&WRAP=day,none,x,x&FORMAT=image/jpeg&WIDTH=443&HEIGHT=382&colormaps=,MODIS_IGBP_Land_Cover_Type,GRUMP_Settlements,&MARKER=31.3372,29.8454&ts=1759554131473"
                  alt="Helwan 2024 Satellite Image"
                />
              </div>
              <p>
                By 2024, significant urban expansion has occurred with increased
                temperatures and reduced natural areas.
              </p>

              <div class="comparison-stats">
                <div class="stat-item">
                  <span class="stat-label">Urban Area:</span>
                  <span class="stat-value-comp">45%</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Population Density:</span>
                  <span class="stat-value-comp">High</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Temperature:</span>
                  <span class="stat-value-comp">36°C</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Vegetation:</span>
                  <span class="stat-value-comp">15%</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Three Separate Stats Section -->
          <div class="three-stats">
            <div class="environment-stat">
              <div class="stat-icon">🌫</div>
              <div class="stat-title">Pollution Reduction</div>
              <div class="stat-desc">
                40% decrease in industrial pollution since 2001 due to better
                regulations and cleaner technologies.
              </div>
            </div>
            <div class="environment-stat">
              <div class="stat-icon">🌿</div>
              <div class="stat-title">Vegetation Growth</div>
              <div class="stat-desc">
                67% increase in green cover through reforestation and urban
                greening initiatives since 2001.
              </div>
            </div>
            <div class="environment-stat">
              <div class="stat-icon">🌡</div>
              <div class="stat-title">Climate Impact</div>
              <div class="stat-desc">
                2°C temperature reduction through reduced urban heat island
                effect and increased vegetation.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      // Game state
      let health = 15;
      let airQuality = 75;
      let vegetation = 25;
      let temperature = 36;
      let currentLevel = 1;
      let darkMode = false;
      let map;
      let actionCooldowns = {
        trees: 0,
        energy: 0,
        recycle: 0,
        roofs: 0,
        transport: 0,
        awareness: 0,
      };
      let cooldownIntervals = {};
      let activeDescription = null;
      let isUserSignedIn = false;

      const messages = [
        "I'm very sick! Pollution is everywhere...",
        "Starting to feel better, but need more help!",
        "Getting healthier! Keep going!",
        "Almost fully healed!",
        "Perfect! I'm completely healthy! 🎉",
      ];

      const emojis = ["😔", "😟", "😊", "😄", "😃"];

      // --- SIGN IN ELEMENTS ---
      const signinBox = document.getElementById("signinBox");
      const usernameInput = document.getElementById("usernameInput");
      const signinBtn = document.getElementById("signinBtn");
      const userWelcome = document.getElementById("userWelcome");
      const signoutBtn = document.getElementById("signoutBtn");
      const signinMessage = document.getElementById("signinMessage");

      // DOM Elements
      const welcomeSection = document.getElementById("welcomeSection");
      const gameSection = document.getElementById("gameSection");
      const nextBtn = document.getElementById("nextBtn");
      const darkModeToggle = document.getElementById("darkModeToggle");
      const restartBtn = document.getElementById("restartBtn");
      const completionMessage = document.getElementById("completionMessage");
      const navLinks = document.querySelectorAll(".nav-links a");
      const tabContents = document.querySelectorAll(".tab-content");
      const actionButtons = document.querySelectorAll(".action-btn");

      // --- LOAD USER ---
      function loadUser() {
        const savedName = localStorage.getItem("healCityUser");
        if (savedName) {
          userWelcome.textContent = "Welcome, " + savedName + "!";
          signinBox.style.display = "none";
          userWelcome.classList.add("show");
          signoutBtn.classList.add("show");
          document.querySelector("header").classList.add("show");
          isUserSignedIn = true;

          // Enable action buttons
          enableActionButtons();
        }
      }

      // --- SIGN IN ---
      signinBtn.addEventListener("click", () => {
        const name = usernameInput.value.trim();
        if (name) {
          localStorage.setItem("healCityUser", name);
          userWelcome.textContent = "Welcome, " + name + "!";
          signinBox.style.display = "none";
          userWelcome.classList.add("show");
          signoutBtn.classList.add("show");
          document.querySelector("header").classList.add("show");
          isUserSignedIn = true;

          // Enable action buttons
          enableActionButtons();

          // Hide error message if shown
          signinMessage.style.display = "none";
        } else {
          // Show error message
          signinMessage.style.display = "block";
        }
      });

      // --- SIGN OUT ---
      signoutBtn.addEventListener("click", () => {
        localStorage.removeItem("healCityUser");
        userWelcome.textContent = "";
        signinBox.style.display = "block";
        userWelcome.classList.remove("show");
        signoutBtn.classList.remove("show");
        document.querySelector("header").classList.remove("show");
        usernameInput.value = "";
        isUserSignedIn = false;

        // Disable action buttons
        disableActionButtons();
      });

      // Event Listeners
      nextBtn.addEventListener("click", startGame);
      darkModeToggle.addEventListener("click", toggleDarkMode);
      restartBtn.addEventListener("click", restartGame);

      // Add event listeners to action buttons
      const actionButtonIds = {
        treesBtn: "trees",
        energyBtn: "energy",
        recycleBtn: "recycle",
        roofsBtn: "roofs",
        transportBtn: "transport",
        awarenessBtn: "awareness",
      };

      Object.keys(actionButtonIds).forEach((btnId) => {
        const btn = document.getElementById(btnId);
        const action = actionButtonIds[btnId];
        const descId = action + "Desc";

        btn.addEventListener("click", () => {
          if (isUserSignedIn) {
            takeAction(action);
          } else {
            alert("Please sign in first to take actions!");
          }
        });
        btn.addEventListener("mouseenter", () => showDescription(descId));
        btn.addEventListener("mouseleave", hideDescription);
      });

      // Add event listeners to navigation links
      navLinks.forEach((link) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          const tabName = link.getAttribute("data-tab");

          // Remove active class from all links
          navLinks.forEach((l) => l.classList.remove("active"));

          // Add active class to clicked link
          link.classList.add("active");

          // Show selected tab
          showTab(tabName);
        });
      });

      // Start game function
      function startGame() {
        welcomeSection.style.display = "none";
        gameSection.style.display = "block";
        gameSection.classList.add("show");

        // Initialize the game
        updateDisplay();
        initMap();
        loadUser();

        // Disable action buttons initially
        if (!isUserSignedIn) {
          disableActionButtons();
        }
      }

      // Disable action buttons
      function disableActionButtons() {
        actionButtons.forEach((btn) => {
          btn.disabled = true;
          btn.style.opacity = "0.5";
          btn.style.cursor = "not-allowed";
        });
      }

      // Enable action buttons
      function enableActionButtons() {
        actionButtons.forEach((btn) => {
          btn.disabled = false;
          btn.style.opacity = "1";
          btn.style.cursor = "pointer";
        });
      }

      // Show solution description
      function showDescription(descId) {
        if (activeDescription) {
          activeDescription.classList.remove("active");
        }
        activeDescription = document.getElementById(descId);
        activeDescription.classList.add("active");
      }

      // Hide solution description
      function hideDescription() {
        if (activeDescription) {
          activeDescription.classList.remove("active");
          activeDescription = null;
        }
      }

      // Initialize map
      function initMap() {
        // Helwan coordinates
        const helwanCoords = [29.841, 31.299];

        // Create map
        map = L.map("helwanMap").setView(helwanCoords, 12);

        // Add OpenStreetMap tiles
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution:
            '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        }).addTo(map);

        // Add marker for Helwan
        L.marker(helwanCoords)
          .addTo(map)
          .bindPopup("Helwan, Egypt<br>Environmental Recovery Zone")
          .openPopup();

        // Add circle to represent environmental impact
        L.circle(helwanCoords, {
          color: "red",
          fillColor: "#f03",
          fillOpacity: 0.2,
          radius: 2000,
        })
          .addTo(map)
          .bindPopup("Area affected by industrial pollution");
      }

      // Tab navigation
      function showTab(tabName) {
        // Hide all tabs
        tabContents.forEach((tab) => {
          tab.classList.remove("active");
        });

        // Show selected tab
        document.getElementById(tabName + "Tab").classList.add("active");
      }

      // Dark mode toggle
      function toggleDarkMode() {
        darkMode = !darkMode;
        document.body.classList.toggle("dark-mode");
        darkModeToggle.querySelector("i").className = darkMode
          ? "fas fa-sun"
          : "fas fa-moon";

        // Save preference
        localStorage.setItem("healcity_darkmode", darkMode);
      }

      // Check for dark mode preference
      function checkDarkModePreference() {
        const darkModePref = localStorage.getItem("healcity_darkmode");
        if (darkModePref === "true") {
          darkMode = true;
          document.body.classList.add("dark-mode");
          darkModeToggle.querySelector("i").className = "fas fa-sun";
        }
      }

      function updateDisplay() {
        // Update health
        document.getElementById("healthFill").style.width = health + "%";
        document.getElementById("healthPercent").textContent = health + "%";

        // Update stats
        document.getElementById("airQuality").textContent = airQuality;
        document.getElementById("vegetation").textContent = vegetation;
        document.getElementById("temperature").textContent = temperature;

        // Update message and emoji
        let level = Math.floor(health / 25);
        if (level > 4) level = 4;

        document.getElementById("cityMessage").textContent = messages[level];
        document.getElementById("cityEmoji").textContent = emojis[level];

        // Update level indicators
        updateLevelIndicators();

        // Update city image color based on health
        const cityImage = document.querySelector(".city-image");
        if (health < 25) {
          cityImage.style.background =
            "linear-gradient(45deg, #e74c3c, #f39c12)";
        } else if (health < 50) {
          cityImage.style.background =
            "linear-gradient(45deg, #f39c12, #f1c40f)";
        } else if (health < 75) {
          cityImage.style.background =
            "linear-gradient(45deg, #f1c40f, #2ecc71)";
        } else {
          cityImage.style.background =
            "linear-gradient(45deg, #2ecc71, #3498db)";
        }

        // Check achievements
        checkAchievements();

        // Check if game is complete
        if (health >= 100) {
          showCompletionMessage();
        } else {
          hideCompletionMessage();
        }
      }

      function updateLevelIndicators() {
        const levels = document.querySelectorAll(".level-dot");
        levels.forEach((dot, index) => {
          const levelNumber = index + 1;
          if (health >= levelNumber * 25) {
            dot.classList.add("completed");
            dot.classList.add("active");
          } else if (levelNumber === currentLevel) {
            dot.classList.add("active");
            dot.classList.remove("completed");
          } else {
            dot.classList.remove("active", "completed");
          }
        });
      }

      function takeAction(action) {
        // Check if action is on cooldown
        if (actionCooldowns[action] > 0) return;

        let healthIncrease = 0;

        switch (action) {
          case "trees":
            healthIncrease = 8;
            vegetation += 8;
            airQuality += 5;
            temperature -= 2;
            break;
          case "energy":
            healthIncrease = 7;
            airQuality += 8;
            temperature -= 3;
            break;
          case "recycle":
            healthIncrease = 5;
            airQuality += 6;
            break;
          case "roofs":
            healthIncrease = 6;
            vegetation += 5;
            airQuality += 5;
            temperature -= 1;
            break;
          case "transport":
            healthIncrease = 6;
            airQuality += 7;
            break;
          case "awareness":
            healthIncrease = 4;
            break;
        }

        // Update health and stats
        health = Math.min(100, health + healthIncrease);
        vegetation = Math.min(100, vegetation);
        airQuality = Math.min(100, airQuality);
        temperature = Math.max(20, temperature);

        // Update level
        currentLevel = Math.min(4, Math.floor(health / 25) + 1);

        // Set cooldown for this action
        setCooldown(action);

        // Add visual feedback
        addActionEffect(action);

        updateDisplay();
      }

      function setCooldown(action) {
        // Set cooldown time (in seconds)
        actionCooldowns[action] = 5;

        // Disable button
        document.getElementById(action + "Btn").disabled = true;

        // Start progress bar animation
        const progressBar = document.getElementById(action + "Progress");
        progressBar.style.width = "100%";

        // Start countdown
        clearInterval(cooldownIntervals[action]);
        cooldownIntervals[action] = setInterval(() => {
          actionCooldowns[action]--;
          progressBar.style.width = (actionCooldowns[action] / 5) * 100 + "%";

          if (actionCooldowns[action] <= 0) {
            clearInterval(cooldownIntervals[action]);
            document.getElementById(action + "Btn").disabled = false;
            progressBar.style.width = "0%";
          }
        }, 1000);
      }

      function addActionEffect(action) {
        // Add a visual effect when action is taken
        const btn = document.getElementById(action + "Btn");
        btn.style.transform = "scale(0.95)";
        setTimeout(() => {
          btn.style.transform = "";
        }, 200);
      }

      function checkAchievements() {
        // First Step - 25% health
        if (health >= 25) {
          document.getElementById("firstStep").classList.add("unlocked");
        }

        // Halfway There - 50% health
        if (health >= 50) {
          document.getElementById("halfway").classList.add("unlocked");
        }

        // Green City - 75% health
        if (health >= 75) {
          document.getElementById("greenCity").classList.add("unlocked");
        }

        // Fully Healed - 100% health
        if (health >= 100) {
          document.getElementById("fullyHealed").classList.add("unlocked");
        }
      }

      function showCompletionMessage() {
        completionMessage.classList.add("active");
      }

      function hideCompletionMessage() {
        completionMessage.classList.remove("active");
      }

      function restartGame() {
        health = 15;
        airQuality = 75;
        vegetation = 25;
        temperature = 36;
        currentLevel = 1;

        // Reset cooldowns
        for (let action in actionCooldowns) {
          actionCooldowns[action] = 0;
          clearInterval(cooldownIntervals[action]);
          document.getElementById(action + "Btn").disabled = false;
          document.getElementById(action + "Progress").style.width = "0%";
        }

        // Reset achievements
        document.querySelectorAll(".progress").forEach((progress) => {
          progress.classList.remove("unlocked");
        });

        // Hide completion message
        hideCompletionMessage();

        updateDisplay();
      }

      // Initialize the application
      checkDarkModePreference();
    </script>
  </body>
</html>
